<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi tiết buổi phỏng vấn</title>
    <link rel="stylesheet" href="{{ base_path }}{{ url_for('static', filename='styles.css') }}">
<link rel="stylesheet" href="{{ base_path }}{{ url_for('static', filename='prism.css') }}">
<script src="{{ base_path }}{{ url_for('static', filename='prism.js') }}"></script>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<!--    <style>-->
<!--        .detail-container { max-width: 1400px; margin: 0 auto; }-->
<!--        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }-->
<!--        .info-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; }-->
<!--        .info-box h3 { margin: 0 0 10px 0; font-size: 14px; opacity: 0.9; }-->
<!--        .info-box .value { font-size: 32px; font-weight: 700; }-->
<!--        .candidates-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }-->
<!--        .candidate-card { border: 2px solid #e2e8f0; border-radius: 8px; padding: 20px; cursor: pointer; transition: all 0.3s; position: relative; }-->
<!--        .candidate-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); transform: translateY(-2px); }-->
<!--        .candidate-card.pending { border-color: #e2e8f0; }-->
<!--        .candidate-card.in_progress { border-color: #ed8936; background: #fffaf0; }-->
<!--        .candidate-card.completed { border-color: #48bb78; background: #f0fff4; }-->
<!--        .status-badge { position: absolute; top: 10px; right: 10px; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500; }-->
<!--        .status-pending { background: #e2e8f0; color: #4a5568; }-->
<!--        .status-in_progress { background: #feebc8; color: #c05621; }-->
<!--        .status-completed { background: #c6f6d5; color: #22543d; }-->
<!--        .interview-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }-->
<!--        .interview-modal.active { display: flex; align-items: center; justify-content: center; }-->
<!--        .modal-content { background: white; border-radius: 12px; max-width: 900px; width: 90%; max-height: 90vh; overflow-y: auto; }-->
<!--        .modal-header { padding: 20px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }-->
<!--        .modal-body { padding: 20px; }-->
<!--        .progress-ring { width: 120px; height: 120px; }-->
<!--        .progress-ring circle { transition: stroke-dashoffset 0.3s; transform: rotate(-90deg); transform-origin: 50% 50%; }-->
<!--    </style>-->
    <script>
        const SESSION_ID = "{{ session_id }}";
        let sessionData = null;
        let currentCandidate = null;
        let currentQuestion = "";
        let currentAudio = null;
        let autoPlayEnabled = true;
        const basePath = window.location.pathname.startsWith('/iview1') ? '/iview1' : '';

        async function loadSessionDetail() {
            try {
                showLoading(true, 'Đang tải thông tin...');

                const response = await fetch(`${basePath}/interview_session/get/${SESSION_ID}`);

                const data = await response.json();

                if (data.success) {
                    sessionData = data.session;
                    displaySessionInfo();
                    displayCandidates();
                } else {
                    alert('Lỗi: ' + data.error);
                }
            } catch (error) {
                console.error('Error loading session:', error);
                alert('Lỗi tải dữ liệu!');
            } finally {
                showLoading(false);
            }
        }

        function displaySessionInfo() {
            document.getElementById('sessionName').textContent = sessionData.session_name;
            document.getElementById('topicName').textContent = sessionData.topic;
            document.getElementById('totalCandidates').textContent = sessionData.total_count;
            document.getElementById('completedCandidates').textContent = sessionData.completed_count;

            const progressPercent = (sessionData.completed_count / sessionData.total_count) * 100;
            document.getElementById('progressPercent').textContent = Math.round(progressPercent) + '%';

            // Update progress ring
            const circle = document.querySelector('.progress-ring circle');
            const radius = circle.r.baseVal.value;
            const circumference = radius * 2 * Math.PI;
            const offset = circumference - (progressPercent / 100) * circumference;
            circle.style.strokeDasharray = `${circumference} ${circumference}`;
            circle.style.strokeDashoffset = offset;

            // Display config
            const config = sessionData.config;
            document.getElementById('configInfo').innerHTML = `
                <div>Threshold High: ${config.threshold_high}</div>
                <div>Threshold Low: ${config.threshold_low}</div>
                <div>Max Questions: ${config.max_total_questions}</div>
                <div>Max Upper Level: ${config.max_upper_level}</div>
                <div>Temperature: ${config.llm_temperature}</div>
            `;

            // Display outline if exists
            if (sessionData.outline && sessionData.outline.length > 0) {
                document.getElementById('outlineInfo').textContent = sessionData.outline.join(', ');
            } else {
                document.getElementById('outlineInfo').textContent = 'Không có outline';
            }
            // Hiển thị phần tóm tắt và đánh giá tài liệu
            document.getElementById('knowledgeSummary').textContent =
                sessionData.knowledge_summary || "Không có tóm tắt tài liệu.";


        }

        function displayCandidates() {
            const container = document.getElementById('candidatesGrid');
            container.innerHTML = sessionData.candidates.map(candidate => {
                const status = candidate.status || 'pending';
                const statusText = {
                    'pending': 'Chưa phỏng vấn',
                    'in_progress': 'Đang phỏng vấn',
                    'completed': 'Đã hoàn thành'
                };

                return `
                    <div class="candidate-card ${status}" onclick="startCandidateInterview('${candidate.name}', '${candidate.class}')">
                        <span class="status-badge status-${status}">${statusText[status]}</span>
                        <h3 style="margin: 0 0 10px 0;">${candidate.name}</h3>
                        <div style="color: #718096;">
                            <i class="fas fa-graduation-cap"></i> ${candidate.class}
                        </div>
                        ${candidate.completed_at ? `
                            <div style="margin-top: 10px; font-size: 12px; color: #718096;">
                                <i class="fas fa-clock"></i> ${new Date(candidate.completed_at).toLocaleString('vi-VN')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        async function startCandidateInterview(candidateName, candidateClass) {
            currentCandidate = { name: candidateName, class: candidateClass };

            showLoading(true, 'Đang khởi tạo phỏng vấn...');

            try {
                // Update status to in_progress
                await fetch(`${basePath}/interview_session/update_candidate_status`, {

                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        session_id: SESSION_ID,
                        candidate_name: candidateName,
                        status: 'in_progress'
                    })
                });

                // Start interview
                const response = await fetch(`${basePath}/interview_session/start_candidate`, {

                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        session_id: SESSION_ID,
                        candidate_name: candidateName,
                        candidate_class: candidateClass
                    })
                });

                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error);
                }

                currentQuestion = data.question;

                // Show modal
                document.getElementById('modalCandidateName').textContent = `${candidateName} (${candidateClass})`;
                document.getElementById('modalQuestion').innerHTML = `<i class="fas fa-robot"></i> ${currentQuestion}`;
                if (window.Prism) Prism.highlightAll();

                document.getElementById('interviewModal').classList.add('active');
                document.getElementById('answerTextarea').value = '';
                document.getElementById('resultSection').style.display = 'none';

                // Play audio if available
                if (data.audio_url) {
                    showAudioControls(data.audio_url);
                    if (autoPlayEnabled) {
                        setTimeout(() => playQuestionAudio(data.audio_url), 500);
                    }
                } else {
                    hideAudioControls();
                }

            } catch (error) {
                console.error('Error starting interview:', error);
                alert('Lỗi: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function submitCandidateAnswer() {
            const answer = document.getElementById('answerTextarea').value.trim();
            if (!answer) {
                alert('Vui lòng nhập câu trả lời!');
                return;
            }

            stopAudio();
            showLoading(true, 'Đang chấm điểm...');

            try {
                const fullName = `${currentCandidate.name},${currentCandidate.class}`;

                const response = await fetch(`${basePath}/interviewing/answer`, {

                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        candidate: fullName,
                        answer: answer
                    })
                });

                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error);
                }

                if (data.finished) {
                    // Interview completed
                    document.getElementById('resultSection').innerHTML = generateSummaryHTML(data.summary);
                    document.getElementById('resultSection').style.display = 'block';
                    document.getElementById('questionSection').style.display = 'none';
                    document.getElementById('answerSection').style.display = 'none';
                    document.getElementById('finishBtn').style.display = 'inline-block';

                    // Update status to completed
                    await fetch(`${basePath}/interview_session/update_candidate_status`, {

                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({
                            session_id: SESSION_ID,
                            candidate_name: currentCandidate.name,
                            status: 'completed'
                        })
                    });

                    hideAudioControls();

                } else {
                    // Continue interview
                    const scoreHTML = generateScoreHTML(data.score, data.analysis);
                    document.getElementById('resultSection').innerHTML = scoreHTML;
                    document.getElementById('resultSection').style.display = 'block';

                    currentQuestion = data.next_question;
                    document.getElementById('modalQuestion').innerHTML = `<i class="fas fa-robot"></i> ${currentQuestion}`;
                    if (window.Prism) Prism.highlightAll();
                    document.getElementById('answerTextarea').value = '';

                    // Play audio
                    if (data.audio_url) {
                        showAudioControls(data.audio_url);
                        if (autoPlayEnabled) {
                            setTimeout(() => playQuestionAudio(data.audio_url), 1000);
                        }
                    } else {
                        hideAudioControls();
                    }

                    // Hide result after 3s
                    setTimeout(() => {
                        document.getElementById('resultSection').style.display = 'none';
                    }, 3000);
                }

            } catch (error) {
                console.error('Error submitting answer:', error);
                alert('Lỗi: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        function closeInterviewModal() {
            document.getElementById('interviewModal').classList.remove('active');
            stopAudio();
            hideAudioControls();
            loadSessionDetail(); // Reload to update status
        }

        function finishInterview() {
            closeInterviewModal();
        }

        function playQuestionAudio(audioUrl) {
            if (!audioUrl || !autoPlayEnabled) return;

            try {
                if (currentAudio) {
                    currentAudio.pause();
                    currentAudio = null;
                }

                currentAudio = new Audio(audioUrl);
                currentAudio.volume = 0.8;

                currentAudio.addEventListener('canplay', () => updateAudioStatus('ready'));
                currentAudio.addEventListener('play', () => updateAudioStatus('playing'));
                currentAudio.addEventListener('pause', () => updateAudioStatus('paused'));
                currentAudio.addEventListener('ended', () => updateAudioStatus('ended'));
                currentAudio.addEventListener('error', (e) => {
                    console.error('Audio error:', e);
                    updateAudioStatus('error');
                });

                currentAudio.play().catch(e => {
                    console.error('Error playing audio:', e);
                    updateAudioStatus('error');
                });

            } catch (error) {
                console.error('Error with audio:', error);
                updateAudioStatus('error');
            }
        }

        function toggleAudioPlayback() {
            if (!currentAudio) return;
            currentAudio.paused ? currentAudio.play() : currentAudio.pause();
        }

        function stopAudio() {
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
                updateAudioStatus('stopped');
            }
        }

        function toggleAutoPlay() {
            autoPlayEnabled = !autoPlayEnabled;
            const autoPlayBtn = document.getElementById('autoPlayBtn');
            if (autoPlayBtn) {
                autoPlayBtn.className = `btn btn-secondary ${autoPlayEnabled ? 'active' : ''}`;
                autoPlayBtn.innerHTML = `<i class="fas fa-${autoPlayEnabled ? 'volume-up' : 'volume-mute'}"></i> ${autoPlayEnabled ? 'Tự động phát' : 'Tắt âm thanh'}`;
            }
        }

        function updateAudioStatus(status) {
            const playBtn = document.getElementById('playBtn');
            const audioStatus = document.getElementById('audioStatus');

            const statusMap = {
                loading: { icon: 'spinner fa-spin', text: 'Đang tải...', color: '#ed8936' },
                ready: { icon: 'play', text: 'Sẵn sàng', color: '#48bb78' },
                playing: { icon: 'pause', text: 'Đang phát', color: '#4299e1' },
                paused: { icon: 'play', text: 'Tạm dừng', color: '#718096' },
                ended: { icon: 'redo', text: 'Kết thúc', color: '#48bb78' },
                stopped: { icon: 'play', text: 'Đã dừng', color: '#718096' },
                error: { icon: 'exclamation-triangle', text: 'Lỗi', color: '#f56565' }
            };

            const statusInfo = statusMap[status] || statusMap.ready;

            if (playBtn) {
                playBtn.innerHTML = `<i class="fas fa-${statusInfo.icon}"></i>`;
                playBtn.disabled = status === 'loading';
            }

            if (audioStatus) {
                audioStatus.innerHTML = statusInfo.text;
                audioStatus.style.color = statusInfo.color;
            }
        }

        function showAudioControls(audioUrl) {
            const questionBody = document.querySelector('#questionSection .card-body');
            let existingControls = questionBody.querySelector('.audio-controls');
            if (existingControls) {
                existingControls.remove();
            }

            const audioControls = document.createElement('div');
            audioControls.className = 'audio-controls';
            audioControls.id = 'audioControls';
            audioControls.innerHTML = `
                <div class="audio-player">
                    <button id="playBtn" class="btn-audio" onclick="toggleAudioPlayback()">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="btn-audio" onclick="stopAudio()">
                        <i class="fas fa-stop"></i>
                    </button>
                    <span id="audioStatus" class="audio-status">Sẵn sàng</span>
                </div>
                <div class="audio-settings">
                    <button id="autoPlayBtn" class="btn btn-secondary ${autoPlayEnabled ? 'active' : ''}" onclick="toggleAutoPlay()">
                        <i class="fas fa-${autoPlayEnabled ? 'volume-up' : 'volume-mute'}"></i>
                        ${autoPlayEnabled ? 'Tự động phát' : 'Tắt âm thanh'}
                    </button>
                </div>
            `;

            questionBody.appendChild(audioControls);
            updateAudioStatus('ready');
        }

        function hideAudioControls() {
            const audioControls = document.getElementById('audioControls');
            if (audioControls) audioControls.remove();
            stopAudio();
        }

        function generateScoreHTML(score, analysis) {
            const scoreClass = score >= 7 ? 'score-good' : score >= 4 ? 'score-average' : 'score-poor';
            return `
                <div class="score-result">
                    <div class="score-display">
                        <div class="score-number ${scoreClass}">${score}/10</div>
                        <div class="score-bar">
                            <div class="score-fill ${scoreClass}" style="width: ${score * 10}%"></div>
                        </div>
                    </div>
                    <div class="score-analysis">
                        <i class="fas fa-comment-alt"></i> ${analysis}
                    </div>
                </div>
            `;
        }

        function generateSummaryHTML(summary) {
            const finalScore = summary.interview_stats?.final_score || 0;
            const scoreClass = finalScore >= 7 ? 'score-good' : finalScore >= 4 ? 'score-average' : 'score-poor';

            let historyHTML = '';
            if (summary.question_history) {
                historyHTML = summary.question_history.map((q) => `
                    <div class="question-history-item">
                        <h4><i class="fas fa-question-circle"></i> Câu ${q.question_number}</h4>
                        <div class="difficulty-badge difficulty-${q.difficulty}">${q.difficulty.replace('_', ' ').toUpperCase()}</div>
                        <p class="question-text">${q.question}</p>
                        <p class="answer-text"><strong>Trả lời:</strong> ${q.answer}</p>
                        <div class="question-score">
                            <span class="score-badge">${q.score}/10</span>
                            <span class="analysis-text">${q.analysis}</span>
                        </div>
                    </div>
                `).join('');
            }

            return `
                <div class="interview-summary">
                    <div class="summary-header">
                        <h3><i class="fas fa-trophy"></i> Kết quả cuối cùng</h3>
                        <div class="final-score ${scoreClass}">${finalScore.toFixed(1)}/10</div>
                    </div>
                    <div class="summary-stats">
                        <div class="stat-item">
                            <span class="stat-label">Tổng câu hỏi:</span>
                            <span class="stat-value">${summary.interview_stats?.total_questions || 0}</span>
                        </div>
                    </div>
                    <div class="question-history">
                        <h4><i class="fas fa-history"></i> Lịch sử câu hỏi</h4>
                        ${historyHTML}
                    </div>
                </div>
            `;
        }

        async function exportResults() {
            window.location.href = `${basePath}/interview_session/export/${SESSION_ID}`;

        }

        async function deleteSession() {
            if (!confirm('Bạn có chắc muốn xóa buổi phỏng vấn này?')) return;

            try {
                const response = await fetch(`${basePath}/interview_session/delete/${SESSION_ID}`, {

                    method: 'DELETE'
                });

                const data = await response.json();
                if (data.success) {
                    alert('Đã xóa buổi phỏng vấn!');
                    window.location.href = '/interview_session';
                }
            } catch (error) {
                alert('Lỗi xóa buổi phỏng vấn!');
            }
        }

        function showLoading(show, message = 'Đang xử lý...') {
            const overlay = document.getElementById('loadingOverlay');
            const text = overlay.querySelector('.loading-text');
            overlay.style.display = show ? 'flex' : 'none';
            if (text) text.textContent = message;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadSessionDetail();
        });
        document.addEventListener('DOMContentLoaded', function() {
    const textarea = document.getElementById('answerTextarea');

    textarea.addEventListener('input', function() {
        // 1. Đặt chiều cao về 'auto' để tính toán lại chiều cao nội dung thực tế
        this.style.height = 'auto';

        // 2. Thiết lập chiều cao bằng scrollHeight (chiều cao cần thiết để hiển thị toàn bộ nội dung)
        // Cộng thêm 1-2 pixel để đảm bảo không bị cắt chữ dưới cùng (tùy trình duyệt)
        this.style.height = (this.scrollHeight) + 'px';
    });
});
    </script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-clipboard-list"></i>
                    <span id="sessionName">Chi tiết buổi phỏng vấn</span>
                </div>
                <div class="header-actions">
                    <a href="{{ base_path }}/interview_session" class="btn btn-secondary btn-sm">
                        <i class="fas fa-arrow-left"></i> Quay lại
                    </a>
                    <button class="btn btn-success btn-sm" onclick="exportResults()">
                        <i class="fas fa-download"></i> Export CSV
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="deleteSession()">
                        <i class="fas fa-trash"></i> Xóa
                    </button>
                </div>
            </div>
        </header>

        <main class="main-content detail-container">
            <!-- Session Info Cards -->
            <div class="info-grid">
                <div class="info-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <h3>Chủ đề</h3>
                    <div id="topicName" class="value" style="font-size: 24px;"></div>
                </div>
                <div class="info-box" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h3>Tổng thí sinh</h3>
                    <div id="totalCandidates" class="value"></div>
                </div>
                <div class="info-box" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>Đã hoàn thành</h3>
                    <div id="completedCandidates" class="value"></div>
                </div>
                <div class="info-box" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <h3>Tiến độ</h3>
                    <div id="progressPercent" class="value"></div>
                </div>
            </div>

            <!-- Progress Ring -->
            <div class="card" style="margin-bottom: 30px;">
                <div class="card-body" style="text-align: center;">
                    <svg class="progress-ring" width="120" height="120">
                        <circle
                            stroke="#e2e8f0"
                            stroke-width="10"
                            fill="transparent"
                            r="52"
                            cx="60"
                            cy="60"
                        />
                        <circle
                            stroke="#48bb78"
                            stroke-width="10"
                            fill="transparent"
                            r="52"
                            cx="60"
                            cy="60"
                            stroke-linecap="round"
                        />
                    </svg>
                </div>
            </div>

            <!-- Config and Outline -->
            <div class="grid-two-columns">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-cog"></i> Cấu hình</h3>
                    </div>
                    <div class="card-body">
                        <div id="configInfo" style="font-size: 14px; line-height: 1.8;"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-list"></i> Outline</h3>
                    </div>
                    <div class="card-body">
                        <div id="outlineInfo" style="font-size: 14px; line-height: 1.8;"></div>
                    </div>
                </div>
            </div>
            <!-- Knowledge Summary & Quality -->
            <div class="card" style="margin-bottom: 30px;">
                <div class="card-header">
                    <h3><i class="fas fa-book-open"></i> Tóm tắt & Đánh giá Tài liệu Phỏng vấn</h3>
                </div>
                <div class="card-body" style="font-size: 14px; line-height: 1.8;">
                    <h4 style="margin-top: 0;">📘 Tóm tắt nội dung</h4>
                    <pre id="knowledgeSummary" style="white-space: pre-wrap; background: #f8f9fa; padding: 10px; border-radius: 8px;">Đang tải...</pre>

                </div>
            </div>

            <!-- Candidates List -->
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-users"></i> Danh sách thí sinh</h2>
                </div>
                <div class="card-body">
                    <div id="candidatesGrid" class="candidates-grid"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Interview Modal -->
    <div id="interviewModal" class="interview-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-circle"></i> <span id="modalCandidateName"></span></h2>
                <button class="btn btn-secondary btn-sm" onclick="closeInterviewModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Question Section -->
                <div id="questionSection" class="card" style="margin-bottom: 20px;">
                    <div class="card-header">
                        <h3><i class="fas fa-question"></i> Câu hỏi</h3>
                    </div>
                    <div class="card-body">
                        <div id="modalQuestion" class="question-text"></div>
                    </div>
                </div>

                <!-- Answer Section -->
                <div id="answerSection" class="card" style="margin-bottom: 20px;">
                    <div class="card-header">
                        <h3><i class="fas fa-keyboard"></i> Câu trả lời</h3>
                    </div>
                    <div class="card-body">
                        <textarea id="answerTextarea" class="form-control" rows="4" placeholder="Nhập câu trả lời..."></textarea>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-success" onclick="submitCandidateAnswer()">
                                <i class="fas fa-paper-plane"></i> Gửi câu trả lời
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Result Section -->
                <div id="resultSection" class="card" style="display: none;">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-line"></i> Kết quả</h3>
                    </div>
                    <div class="card-body">
                        <!-- Dynamic content -->
                    </div>
                </div>

                <!-- Finish Button -->
                <div style="text-align: center;">
                    <button id="finishBtn" class="btn btn-primary" onclick="finishInterview()" style="display: none;">
                        <i class="fas fa-check"></i> Hoàn thành và đóng
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <div class="loading-text">Đang xử lý...</div>
    </div>
</body>
</html>